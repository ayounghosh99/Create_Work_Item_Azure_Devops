import{__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./Sizer.css";import*as React from"react";import{ObservableLike}from"../../Core/Observable";import{TimerManagement}from"../../Core/TimerManagement";import{Observer}from"../../Observer";import{Portal}from"../../Portal";import{css,KeyCode,Mouse}from"../../Util";import{Orientation,Position}from"./Sizer.Props";var Sizer=function(e){function t(t){var o=e.call(this,t)||this;return o.lastLocation=-1,o.timerManagement=new TimerManagement,o.state={showPortal:!1},o.onMouseCapture=function(e){o.lastLocation+=o.updateSize(e,o.getMouseLocation(e)-o.lastLocation),"mouseup"===e.type&&(o.setState({showPortal:!1}),o.onSizeEnd())},o.onKeyDown=function(e){if(!e.defaultPrevented){var t=void 0;o.props.orientation===Orientation.row?e.which===KeyCode.leftArrow?t=o.updateSize(e.nativeEvent,-1):e.which===KeyCode.rightArrow&&(t=o.updateSize(e.nativeEvent,1)):e.which===KeyCode.upArrow?t=o.updateSize(e.nativeEvent,-1):e.which===KeyCode.downArrow&&(t=o.updateSize(e.nativeEvent,1)),t&&(e.preventDefault(),o.debouncedEnd())}},o.onSizeEnd=function(){o.props.onSizeEnd&&o.props.onSizeEnd(o.props.id)},o.onMouseDown=function(e){e.defaultPrevented||(o.lastLocation=o.getMouseLocation(e.nativeEvent),Mouse.setCapture(o.onMouseCapture),o.setState({showPortal:!0}),e.preventDefault())},o.debouncedEnd=o.timerManagement.debounce(o.onSizeEnd,500,{trailing:!0}),o}return __extends(t,e),t.prototype.render=function(){var e=this.props.divider;return React.createElement("div",{"aria-label":this.props.ariaLabel,"aria-valuemin":this.props.minSize,"aria-valuemax":this.props.maxSize,"aria-valuenow":ObservableLike.getValue(this.props.size),className:css(this.props.className,"bolt-sizer",this.props.orientation===Orientation.row?"bolt-sizer-row flex-row":"bolt-sizer-column flex-column",e&&"divider"),id:this.props.id,onKeyDown:this.onKeyDown,onMouseDown:this.onMouseDown,role:"separator",tabIndex:this.props.tabIndex},this.state.showPortal&&React.createElement(Portal,{className:css("bolt-sizer-portal",this.props.orientation===Orientation.row?"bolt-sizer-portal-row":"bolt-sizer-portal-column")},React.createElement("div",null)))},t.prototype.componentWillUnmount=function(){Mouse.releaseCapture(this.onMouseCapture),this.timerManagement.dispose()},t.prototype.getMouseLocation=function(e){return this.props.orientation===Orientation.row?e.pageX:e.pageY},t.prototype.updateSize=function(e,t){var o=ObservableLike.getValue(this.props.size),i=this.props.position===Position.far?-1:1,r=Math.floor(Math.min(this.props.maxSize,Math.max(this.props.minSize,o+t*i)));return this.props.onSize(e,r,this.props.id),(r-o)*i},t.defaultProps={divider:!0,maxSize:1e4,minSize:100},t}(React.Component);export{Sizer};export function Sized(e){return React.createElement(Observer,{height:e.height,width:e.width},function(t){var o={};return void 0!==t.height&&(o.height=t.height+"px"),void 0!==t.width&&(o.width=t.width+"px"),React.createElement("div",{className:css(e.className,"flex-noshrink"),style:o},e.children)})};