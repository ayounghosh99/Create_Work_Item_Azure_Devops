import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import*as React from"react";var FocusWithinContext=React.createContext({}),FocusWithin=function(o){function t(){var t=null!==o&&o.apply(this,arguments)||this;return t.blurTimeout=-1,t.focusCount=0,t.focus=!1,t.onBlur=function(){t.focusCount=Math.max(0,t.focusCount-1),-1!==t.blurTimeout&&window.clearTimeout(t.blurTimeout),t.blurTimeout=window.setTimeout(function(){t.blurTimeout=-1,t.focusCount||(t.focus=!1,t.props.updateStateOnFocusChange&&t.forceUpdate(),t.props.onBlur&&t.props.onBlur())},0)},t.onFocus=function(o){t.focusCount++,t.focus||(t.focus=!0,t.props.updateStateOnFocusChange&&t.forceUpdate(),t.props.onFocus&&t.props.onFocus(o))},t}return __extends(t,o),t.prototype.render=function(){var o=this;return React.createElement(FocusWithinContext.Consumer,null,function(t){var n,u={onBlur:o.onBlur,onFocus:o.onFocus};if(o.parentFocusWithin=t.focusWithin,"function"==typeof o.props.children){s=o.props.children;u.hasFocus=o.focus,n=s(u)}else{var s=React.Children.only(o.props.children);n=React.cloneElement(s,__assign(__assign({},s.props),u),s.props.children)}return React.createElement(FocusWithinContext.Provider,{value:{focusWithin:o}},n)})},t.prototype.componentWillUnmount=function(){-1!==this.blurTimeout&&(window.clearTimeout(this.blurTimeout),this.blurTimeout=-1),this.focusCount>0&&this.unmountWithFocus(!1)},t.prototype.hasFocus=function(){return this.focusCount>0},t.prototype.unmountWithFocus=function(o){this.focusCount>0&&(this.focusCount--,this.focusCount>0&&o&&(this.focusCount=0,this.focus=!1,this.props.updateStateOnFocusChange&&this.forceUpdate(),this.props.onBlur&&this.props.onBlur()),this.parentFocusWithin&&this.parentFocusWithin.unmountWithFocus(!0))},t.defaultProps={updateStateOnFocusChange:!0},t}(React.Component);export{FocusWithin};