import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./ExpandableTextField.css";import*as React from"react";import{Expandable}from"../../Expandable";import{FocusWithin}from"../../FocusWithin";import{IconSize}from"../../Icon";import{TextField}from"../../TextField";import{css,KeyCode}from"../../Util";import{Location}from"../../Utilities/Position";var textFieldId=1,ExpandableTextField=function(e){function o(o){var n=e.call(this,o)||this;return n.textFieldElement=React.createRef(),n.expandable=React.createRef(),n.collapse=function(){n.expandable.current&&n.expandable.current.collapse()},n.expand=function(){n.expandable.current&&n.expandable.current.expand()},n.renderCallout=function(){return n.props.renderCallout(n,n.dropdownId,n.props.anchorElement?n.props.anchorElement:n.props.anchorPoint?void 0:n.containerElement.current?n.containerElement.current:void 0,n.props.anchorOffset||{horizontal:0,vertical:0},n.props.anchorOrigin||{horizontal:Location.end,vertical:Location.end},n.props.anchorPoint,n.props.dropdownOrigin||{horizontal:Location.end,vertical:Location.start})},n.dropdownId=o.dropdownId||"dropdown-"+textFieldId++,n.containerElement=o.containerRef||React.createRef(),n}return __extends(o,e),o.prototype.render=function(){var e=this;return React.createElement(Expandable,{disabled:this.props.disabled,expandKey:this.props.expandKey,onCollapse:this.props.onCollapse,onExpand:this.props.onExpand,renderCallout:this.renderCallout,ref:this.expandable},function(o){return React.createElement(FocusWithin,{onFocus:e.props.onFocus,onBlur:e.props.onBlur},function(n){return React.createElement("div",{className:css(e.props.className,"bolt-expandable-textfield"),onBlur:function(){e.props.blurDismiss&&e.collapse(),n.onBlur&&n.onBlur()},onFocus:function(o){n.onFocus&&n.onFocus(o),o.target===e.containerElement.current&&e.focus()},onMouseDown:o.onMouseDown,onKeyDown:o.onKeyDown,ref:e.containerElement,role:e.props.editable?"combobox":void 0,"aria-expanded":e.props.editable?o.expanded:void 0,tabIndex:-1},React.createElement(TextField,__assign({ariaHasPopup:"dialog"},e.props,{ariaActiveDescendant:o.expanded?e.props.ariaActiveDescendant:void 0,role:e.props.editable?"textbox":void 0,ariaExpanded:e.props.editable?void 0:o.expanded,ariaControls:o.expanded?e.dropdownId:void 0,className:"",onClick:o.onClick,ref:e.textFieldElement,suffixIconProps:e.props.hideDropdownIcon?void 0:{key:"dropdown-icon",className:css("bolt-expandable-textfield-icon icon-right",e.props.disabled&&"disabled"),iconName:"ChevronDownMed",onClick:o.onClick,size:IconSize.small}})))})})},o.prototype.focus=function(){this.textFieldElement.current&&this.textFieldElement.current.focus()},o.prototype.select=function(){this.textFieldElement.current&&this.textFieldElement.current.select()},o.defaultProps={expandKey:[KeyCode.downArrow,KeyCode.enter]},o}(React.Component);export{ExpandableTextField};