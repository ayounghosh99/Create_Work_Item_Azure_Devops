import{__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./SuggestionsList.css";import*as React from"react";import{ObservableLike}from"../../Core/Observable";import{FocusWithin}from"../../FocusWithin";import{Observer}from"../../Observer";import{Spinner}from"../../Spinner";import{css,getSafeId,preventDefault}from"../../Util";var SuggestionsItem=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSuggestionClicked=function(e){e.isDefaultPrevented()||(t.props.onClick(t.props),e.preventDefault())},t}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.renderSuggestion,s=e.className,o=e.isSelected;return React.createElement("div",{className:css(s,"bolt-suggestions-item flex-row flex-grow cursor-pointer scroll-hidden",o&&"bolt-suggestions-isSuggested")},React.createElement("div",{onMouseDown:preventDefault,onClick:this.onSuggestionClicked,className:"bolt-suggestions-item-button flex-row flex-grow scroll-hidden"},t(this.props)))},t}(React.Component);export{SuggestionsItem};var SuggestionsList=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollableRegion=React.createRef(),t.selectedElement=React.createRef(),t.onBlur=function(){t.props.onBlur&&t.props.onBlur()},t.onFocus=function(e){t.props.onFocus&&t.props.onFocus(e)},t}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,s=e.loadingText,o=e.renderNoResultFound,n=ObservableLike.getValue(this.props.suggestions),r=ObservableLike.getValue(this.props.isLoading),i=!(n&&n.length||r);return React.createElement("div",{className:css(t,"bolt-suggestions flex-row flex-grow"),id:getSafeId("suggestions-list"),style:this.props.width&&{width:this.props.width}},r?React.createElement(Spinner,{className:"bolt-suggestions-spinner flex-grow flex-center justify-center",id:"suggestions-spinner",label:s}):!i&&this.renderSuggestions(),React.createElement("div",{className:css("bolt-suggestions-none-region",i?"flex-row flex-grow":"has-suggestions"),id:getSafeId("sug-list-no-results"),role:"text"},i&&(o?o():this.noResults())),React.createElement("div",{"aria-label":s||"Loading",id:getSafeId("sug-list-transition"),role:"text"}))},t.prototype.componentDidMount=function(){this.scrollSelected()},t.prototype.componentDidUpdate=function(){this.selectedElement.current&&this.currentSelectedElement!==this.selectedElement.current&&this.scrollSelected()},t.prototype.noResults=function(){var e=this.props.noResultsFoundText;return e?React.createElement("div",{className:"bolt-suggestions-none flex-row flex-grow flex-center"},e):null},t.prototype.renderSuggestions=function(){var e=this,t=this.props,s=t.createDefaultItem,o=t.renderSuggestion,n=t.onSuggestionClicked,r=t.suggestionsItemClassName,i=t.resultsMaximumNumber,l=t.selectedIndex,c=t.suggestions,u=t.suggestionsContainerAriaLabel,a=t.width;return React.createElement(FocusWithin,{onBlur:this.onBlur,onFocus:this.onFocus},function(t){return React.createElement(Observer,{suggestions:c,selectedIndex:l},function(l){i&&(l.suggestions=l.suggestions.slice(0,i));var c=l.suggestions;return s&&c.unshift(s(c)),React.createElement("div",{"aria-label":u,className:"bolt-suggestions-container flex-column flex-grow v-scroll-auto h-scroll-hidden",id:getSafeId("suggestion-list"),ref:e.scrollableRegion,role:"listbox",style:a&&{width:a}},React.createElement("div",{className:"bolt-suggestion-spacer",onMouseDown:preventDefault}),l.suggestions.map(function(s,i){var c=i===l.selectedIndex;return React.createElement("div",{className:"flex-noshrink",key:getSafeId("sug-"+i),id:getSafeId("sug-row-"+i),ref:c?e.selectedElement:"",role:"option"},React.createElement(SuggestionsItem,{className:r,id:getSafeId("sug-item"+i),index:i,isSelected:c,item:s,onBlur:t.onBlur,onFocus:t.onFocus,onClick:n,renderSuggestion:o}))}),React.createElement("div",{className:"bolt-suggestion-spacer",onMouseDown:preventDefault}))})})},t.prototype.scrollSelected=function(){var e,t;this.currentSelectedElement=null===(e=this.selectedElement)||void 0===e?void 0:e.current,this.scrollableRegion.current&&(null===(t=this.selectedElement)||void 0===t?void 0:t.current)&&(this.scrollableRegion.current.scrollTop=this.selectedElement.current.offsetTop)},t}(React.Component);export{SuggestionsList};