import{__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./IdentityCard.css";import*as React from"react";import*as Resources from"../../Resources.Persona";import{Callout}from"../../Callout";import{FocusZone,FocusZoneDirection}from"../../FocusZone";import{Location}from"../../Utilities/Position";import{Spinner,SpinnerSize}from"../../Spinner";import{css,KeyCode}from"../../Util";import{ContactCard}from"./ContactCard";import{DefaultAbridgedCard}from"./DefaultAbridgedCard";import{DefaultCard}from"./DefaultCard";import{DefaultSimpleCard}from"./DefaultSimpleCard";import{GitHubCard}from"./GitHubCard";import{GroupCard}from"./GroupCard";import{GroupMembersCard}from"./GroupMembersCard";import{CardType}from"./IdentityCard.Props";import{IdentityCardHeaderElement as HeaderElement}from"./IdentityCardHeaderElement";import*as Utils from"./IdentityCardIdentityUtils";import{OrganizationCard}from"./OrganizationCard";var IdentityCardContent=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onKeyDown=function(t){t.which===KeyCode.escape&&(e.onDismissCallout(),t.preventDefault())},e.onDismissCallout=function(){e.props.onDismissCallback&&e.props.onDismissCallback()},e}return __extends(e,t),e.prototype.render=function(){var t=this.props.referenceHTMLComponent?this.props.referenceHTMLComponent:this.props.target;return React.createElement(Callout,{onDismiss:this.onDismissCallout,anchorElement:t,anchorOrigin:{horizontal:Location.end,vertical:Location.start},calloutOrigin:{horizontal:Location.start,vertical:Location.start},ariaLabel:Resources.IdentityCardProfileCardAriaLabel,className:"bolt-identity-card-callout h-scroll-hidden depth-8",contentClassName:"v-scroll-auto",escDismiss:!0,lightDismiss:!0,ref:this.props.calloutRef},React.createElement("div",null,this.renderCard()))},e.prototype.renderCard=function(){if(this.props.working&&!Utils.isCompleteIdentity(this.props.dataProps.identity))return React.createElement("div",{className:css("bolt-identity-card scroll-h-hidden","loading flex-row justify-center")},React.createElement(Spinner,{label:Resources.Loading,size:SpinnerSize.large,className:"bolt-identity-card-loading-spinner"}));var t=Utils.isAdUser(this.props.dataProps.identity)||Utils.isAadUser(this.props.dataProps.identity)||Utils.isGroup(this.props.dataProps.identity),e=this.props.dataProps.header||void 0,r=this.renderInnerCard();return r?React.createElement(FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-identity-card-focus-element",direction:FocusZoneDirection.Vertical,focusOnMount:!0,handleTabKey:!0},React.createElement("div",{className:"bolt-identity-card-focus-element",tabIndex:-1}),React.createElement("div",{className:"bolt-identity-card scroll-h-hidden",onKeyDown:this.onKeyDown},t&&e&&React.createElement(HeaderElement,{identity:e,onClickFunction:this.props.onHeaderClick}),r)):React.createElement("div",null)},e.prototype.renderInnerCard=function(){var t=this.props.dataProps,e=t.identity,r=t.successors,i=t.managerList,a=t.directReportList;if(!e||!0===this.props.showUnknownUser)return React.createElement("div",{className:"bolt-identity-card-content bolt-identity-card-unknown-user-content flex-column flex-center justify-center title-xs scroll-hidden"},Resources.IdentityCardUnknownUser);var o=Utils.isGroup(e),n=Utils.isVsdUser(e),s=Utils.isWmdUser(e),d=Utils.isAadUser(e),l=Utils.isAdUser(e),c=Utils.isGithubUser(e);if(o)switch(this.props.dataProps.cardType){case CardType.Organization:return React.createElement(GroupMembersCard,{identity:e,members:r,onClickEntity:this.props.onClickEntity});case CardType.Default:return React.createElement(GroupCard,{identity:e,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,members:r,showOrganizationCard:this.props.onShowOrganizationCard})}else{if(c)return React.createElement(GitHubCard,{identity:e});if(n)return React.createElement(DefaultAbridgedCard,{identity:e});if(s)return React.createElement(DefaultSimpleCard,{identity:e});if(d||l)switch(this.props.dataProps.cardType){case CardType.Contact:return React.createElement(ContactCard,{identity:e});case CardType.Organization:return React.createElement(OrganizationCard,{identity:e,managerList:i,directReportList:a,onClickEntity:this.props.onClickEntity});case CardType.Default:default:var p=i&&i.length>0?i[i.length-1]:void 0;return React.createElement(DefaultCard,{identity:e,manager:p,isPreviousHeader:!!this.props.dataProps.previousDataState||!!this.props.initialHeader,showContactCard:this.props.onShowContactCard,showOrganizationCard:this.props.onShowOrganizationCard,onClickEntity:this.props.onClickEntity})}}return React.createElement("div",null)},e}(React.Component);export{IdentityCardContent};