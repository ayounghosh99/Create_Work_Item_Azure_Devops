import{__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./ProgressBar.css";import*as React from"react";import{ObservableLike}from"../../Core/Observable";import{TimerManagement}from"../../Core/TimerManagement";import{Observer}from"../../Observer";import{css}from"../../Util";var IndeterminateProgressBar=function(e){function t(t){var r=e.call(this,t)||this;return r.timerManagement=new TimerManagement,r.transitionDurations=350,r.randomize25=function(e){return.25*(Math.random()*e*2+(1-e))},r.randomize75=function(e){return.75*(Math.random()*e*2+(1-e))},r.asymptoticApproach=function(e){return 1-1/Math.sqrt(e+1)},r.done=function(){r.state.progress!==1/0&&r.setState({progress:1/0})},r.increment=function(){r.state.progress!==1/0&&r.setState({progress:r.state.progress+r.randomize25(1)})},r.reset=function(){0!==r.state.progress&&r.setState({progress:0})},r.shouldRun=function(){return void 0!=r.props.loading},r.updateProgress=function(e){e?r.reset():r.done()},r.state={progress:0},r}return __extends(t,e),Object.defineProperty(t.prototype,"transitionDuration",{get:function(){return this.state.progress?this.transitionDurations:0},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this;return React.createElement(Observer,{loading:{observableValue:this.props.loading,filter:this.updateProgress}},function(){return React.createElement("span",{className:css(e.props.className,"bolt-progress-bar-container flex-row flex-noshrink flex-grow scroll-hidden")},React.createElement("span",{className:css(e.props.progressBarClassName,"bolt-progress-bar-bar",e.state.progress===1/0&&"complete"),style:{transform:"scaleX("+e.asymptoticApproach(e.state.progress)+")"}}))})},t.prototype.componentDidMount=function(){this.shouldRun()&&this.scheduleUpdate(this.increment,0,!1)},t.prototype.componentDidUpdate=function(e){var t=this;this.shouldRun()&&(this.state.progress==1/0?this.props.loadingAnimationComplete&&this.timerManagement.setTimeout(function(){t.props.loadingAnimationComplete&&t.props.loadingAnimationComplete()},this.transitionDuration):this.scheduleUpdate(this.increment,this.transitionDuration,!1)),void 0===this.props.loading?this.reset():void 0!==e.loading&&!ObservableLike.getValue(e.loading)||ObservableLike.getValue(this.props.loading)||this.done()},t.prototype.componentWillUnmount=function(){this.timerManagement.dispose()},t.prototype.scheduleUpdate=function(e,t,r){this.timerManagement.setTimeout(function(){e()},t)},t}(React.PureComponent);export{IndeterminateProgressBar};