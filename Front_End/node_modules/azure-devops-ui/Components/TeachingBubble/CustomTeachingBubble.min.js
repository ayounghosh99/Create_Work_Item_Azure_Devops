import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./TeachingBubble.css";import*as React from"react";import{TeachingBubbleCornerPlacement}from"./TeachingBubble.Props";import{Callout}from"../../Callout";import{FocusZoneKeyStroke}from"../../FocusZone";import{css,KeyCode}from"../../Util";import{ScreenSize}from"../../Core/Util/Screen";import{Location}from"../..//Utilities/Position";import{ScreenSizeObserver}from"../../Utilities/ScreenSize";var CustomTeachingBubble=function(e){function t(t){var o=e.call(this,t)||this;return o.dismiss=function(){o.setState({fadingOut:!0})},o.onAnimationEnd=function(){o.state.fadingOut?o.props.onDismiss&&o.props.onDismiss():o.state.newPosition&&o.setState({anchorElement:o.props.anchorElement,anchorOrigin:o.props.anchorOrigin,children:o.props.children,cornerPlacement:o.props.cornerPlacement,newPosition:!1},o.props.onLocationChange)},o.getCalloutOrigin=function(e,t){return e.horizontal===Location.center?t=TeachingBubbleCornerPlacement.vertical:e.vertical===Location.center&&(t=TeachingBubbleCornerPlacement.horizontal),t===TeachingBubbleCornerPlacement.horizontal?e.horizontal===Location.start?{horizontal:Location.end,vertical:e.vertical}:e.horizontal===Location.end?{horizontal:Location.start,vertical:e.vertical}:{horizontal:Location.center,vertical:e.vertical}:e.vertical===Location.start?{horizontal:e.horizontal,vertical:Location.end}:e.vertical===Location.end?{horizontal:e.horizontal,vertical:Location.start}:{horizontal:e.horizontal,vertical:Location.center}},o.getBeakClassName=function(e,t){var o,n;return o=t.horizontal===Location.start?e.horizontal===Location.end?"left-primary":"left-secondary":t.horizontal===Location.end?e.horizontal===Location.start?"right-primary":"right-secondary":"center-h",n=t.vertical===Location.start?e.vertical===Location.end?"top-primary":"top-secondary":t.vertical===Location.end?e.vertical===Location.start?"bottom-primary":"bottom-secondary":"center-v",css(o,n)},o.state={anchorElement:t.anchorElement,anchorOrigin:t.anchorOrigin,children:t.children,cornerPlacement:o.props.cornerPlacement},o}return __extends(t,e),t.getDerivedStateFromProps=function(e,t){return t.anchorElement!==e.anchorElement||t.anchorOrigin.horizontal!==e.anchorOrigin.horizontal||t.anchorOrigin.vertical!==e.anchorOrigin.vertical?__assign(__assign({},t),{newPosition:!0}):{children:e.children,cornerPlacement:e.cornerPlacement}},t.prototype.render=function(){var e=this,t=this.state,o=t.anchorElement,n=t.anchorOrigin,r=t.children,i=t.cornerPlacement,a=void 0===i?TeachingBubbleCornerPlacement.vertical:i,c=t.fadingOut,l=t.newPosition,s=this.getCalloutOrigin(n,a);return React.createElement(ScreenSizeObserver,null,function(t){var i,a=t.screenSize===ScreenSize.xsmall;return a||(i=n.vertical===Location.end?window.innerHeight-o.getBoundingClientRect().bottom:n.vertical===Location.start?o.getBoundingClientRect().top:window.innerHeight),React.createElement(Callout,{anchorElement:a?void 0:o,anchorPoint:a?{x:0,y:0}:void 0,anchorOrigin:n,ariaDescribedBy:e.props.ariaDescribedBy,ariaLabelledBy:e.props.ariaLabeledBy,blurDismiss:e.props.textOnly,calloutOrigin:s,className:css(a&&"absolute-fill"),contentClassName:css("bolt-bubble-callout",(c||l)&&"fade-out",e.getBeakClassName(n,s),a?"bolt-bubble-fullscreen absolute-fill flex-grow scroll-auto":"relative"),contentShadow:!0,escDismiss:!0,fixedLayout:!0,focuszoneProps:{circularNavigation:!0,defaultActiveElement:e.props.defaultActiveElement||".bolt-bubble-focusable-element",focusOnMount:!0,handleTabKey:!0,includeDefaults:!0,postprocessKeyStroke:function(e){return e.which===KeyCode.tab&&e.preventDefault(),FocusZoneKeyStroke.IgnoreParents}},onAnimationEnd:e.onAnimationEnd,onDismiss:e.dismiss,updateLayout:!0,viewportChangeDismiss:!1},React.createElement("div",{"aria-live":"polite","aria-relevant":"text",className:"bolt-bubble-container"},!a&&React.createElement("div",{className:"bolt-bubble-beak depth-8"}),React.createElement("div",{className:"bolt-bubble-content relative scroll-auto",style:{maxHeight:i}},React.createElement("div",{className:"bolt-bubble-focusable-element no-outline",tabIndex:-1}),r)))})},t}(React.Component);export{CustomTeachingBubble};