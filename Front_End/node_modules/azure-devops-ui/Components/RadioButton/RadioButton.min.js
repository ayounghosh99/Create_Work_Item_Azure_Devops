import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./RadioButton.css";import*as React from"react";import{ObservableLike}from"../../Core/Observable";import{FocusGroupContext}from"../../FocusGroup";import{FocusZone,FocusZoneContext,FocusZoneDirection,FocusZoneKeyStroke}from"../../FocusZone";import{FormItem,FormItemContext}from"../../FormItem";import{Observer}from"../../Observer";import{Tooltip}from"../../TooltipEx";import{css,getSafeId,isArrowKey,noop}from"../../Util";import{getTabIndex}from"../../Utilities/Focus";import{RadioButtonGroupDirection}from"./RadioButton.Props";export var RadioButtonGroupContext=React.createContext({onSelect:noop,registerId:noop});var RadioButtonGroup=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.focusGroupContext=React.createRef(),e.idMap={},e.onChange=function(t){e.props.onSelect&&e.props.onSelect(t)},e.getFirstButtonId=function(){var t=React.Children.toArray(e.props.children);if(t.length){return t[0].props.id}},e.postProcessKeystroke=function(t){if(document.activeElement&&isArrowKey(t)){var o=e.idMap[document.activeElement.id];o&&o!==ObservableLike.getValue(e.props.selectedButtonId||"")&&e.props.onSelect&&e.props.onSelect(o)}return FocusZoneKeyStroke.IgnoreNone},e.registerId=function(t,o){e.idMap[t]=o},e}return __extends(e,t),e.prototype.render=function(){var t=this,e=this.props,o=e.className,r=e.defaultButtonId,n=e.direction,s=e.excludeFocusZone,i=e.id,a=e.selectedButtonId,c=e.text,u=css("bolt-radio-button-group",n===RadioButtonGroupDirection.Vertical?"flex-column":"flex-row",this.props.groupClassName);return React.createElement(Observer,{selectedButtonId:a},function(e){return React.createElement(RadioButtonGroupContext.Provider,{value:{onSelect:t.onChange,registerId:t.registerId,selectedButtonId:e.selectedButtonId||t.getFirstButtonId()}},React.createElement(FormItem,{className:css(o,"bolt-radio-button-group-container",s&&u),label:c},s?t.props.children:React.createElement(FormItemContext.Consumer,null,function(o){return React.createElement(FocusZone,{direction:n===RadioButtonGroupDirection.Vertical?FocusZoneDirection.Vertical:FocusZoneDirection.Horizontal,circularNavigation:!0,focusGroupProps:{defaultElementId:r||e.selectedButtonId||t.getFirstButtonId(),ref:t.focusGroupContext},postprocessKeyStroke:t.postProcessKeystroke},React.createElement("div",{"aria-labelledby":getSafeId(o.ariaLabelledById),className:u,role:"radiogroup",id:getSafeId(i)},t.props.children))})))})},e.prototype.focus=function(){this.focusGroupContext.current&&this.focusGroupContext.current.focus()},e.defaultProps={direction:RadioButtonGroupDirection.Vertical},e}(React.Component);export{RadioButtonGroup};var RadioButton=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radioButtonInternal=React.createRef(),e}return __extends(e,t),e.prototype.render=function(){var t=this;return React.createElement(RadioButtonGroupContext.Consumer,null,function(e){return React.createElement(FocusGroupContext.Consumer,null,function(o){return React.createElement(FocusZoneContext.Consumer,null,function(r){return React.createElement(RadioButtonInternal,__assign({},t.props,{focusGroupContext:o,focuszoneId:r.focuszoneId,onFocus:o.onFocus,onSelect:e.onSelect,registerId:e.registerId,selectedButton:e.selectedButtonId===t.props.id,ref:t.radioButtonInternal}))})})})},e.prototype.focus=function(){this.radioButtonInternal.current&&this.radioButtonInternal.current.focus()},e}(React.Component);export{RadioButton};var RadioButtonInternal=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.radioButton=React.createRef(),e.onClick=function(t){t.defaultPrevented||e.props.disabled||(e.props.onSelect(e.props.id),t.preventDefault())},e.onFocus=function(t){e.props.onFocus(e.props.id)},e}return __extends(e,t),e.prototype.render=function(){var t=getTabIndex(this.props,this.props.focusGroupContext),e=this.props.text&&"rb-label-"+this.props.id,o=React.createElement("div",{"aria-checked":this.props.selectedButton,"aria-disabled":this.props.disabled,"aria-labelledby":getSafeId(this.props.ariaLabelledBy||e),"aria-describedby":getSafeId(this.props.ariaDescribedBy),className:css(this.props.className,"bolt-radio-button cursor-pointer",this.props.disabled?"disabled":"enabled",this.props.selectedButton&&"checked",(this.props.text||React.Children.count(this.props.children)>0)&&"labelled","bolt-focus-treatment"),"data-focuszone":this.props.disabled||this.props.excludeFocusZone?void 0:this.props.focuszoneId,"data-is-focusable":this.props.disabled?"false":"true",id:getSafeId(this.props.id),key:this.props.id,onClick:this.onClick,onFocus:this.onFocus,ref:this.radioButton,role:this.props.role||"radio",tabIndex:t},React.createElement("div",{className:"bolt-radio-button-icon"},React.createElement("div",{className:"bolt-radio-button-bullet"})),this.props.text&&React.createElement("div",{className:"bolt-radio-button-label",id:getSafeId(e)},this.props.text),this.props.children);return this.props.tooltipProps&&(o=React.createElement(Tooltip,__assign({},this.props.tooltipProps),o)),o},e.prototype.componentDidMount=function(){var t=this.props,e=t.id;(0,t.registerId)(getSafeId(e),e)},e.prototype.focus=function(){this.radioButton.current&&this.radioButton.current.focus()},e}(React.Component);