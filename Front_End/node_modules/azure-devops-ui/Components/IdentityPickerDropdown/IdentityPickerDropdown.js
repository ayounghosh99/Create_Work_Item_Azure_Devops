import { __assign } from "tslib";
import "../../CommonImports";
import "../../Core/core.css";
import "./IdentityPickerDropdown.css";
import * as React from "react";
import { ObservableLike, useObservable } from '../../Core/Observable';
import { CustomIdentityPickerDropdown } from "./CustomIdentityPickerDropdown";
export var IdentityPickerDropdown = function (props) {
    var _a = useObservable(props.value && ObservableLike.getValue(props.value) ? ObservableLike.getValue(props.value).displayName : ""), textValue = _a[0], setTextValue = _a[1];
    var _b = useObservable(false), suggestionsVisible = _b[0], setSuggestionsVisible = _b[1];
    var onChange = props.onChange;
    var suggestionsVisibleChanged = function (opened) {
        props.onSuggestionsVisibleChanged && props.onSuggestionsVisibleChanged(opened);
        setSuggestionsVisible(opened);
    };
    var onPersonaChange = function (item) {
        if (onChange(item) !== false) {
            setTextValue(item ? item.displayName || item.mailNickname : "");
            return true;
        }
        else {
            setTextValue("");
            return false;
        }
    };
    var deps = ObservableLike.isObservable(props.value) ? [props.value.value] : [props.value];
    React.useEffect(function () {
        setTextValue((props.value && ObservableLike.getValue(props.value) && ObservableLike.getValue(props.value).displayName) || "");
    }, deps);
    return (React.createElement(CustomIdentityPickerDropdown, __assign({}, props, { suggestionsVisible: suggestionsVisible, onChange: onPersonaChange, onInputChange: setTextValue, onSuggestionsVisibleChanged: suggestionsVisibleChanged, textValue: textValue })));
};
