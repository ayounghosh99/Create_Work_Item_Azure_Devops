import{__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./TeachingPanel.css";import*as React from"react";import{Button}from"../../Button";import{Callout,ContentJustification,ContentLocation,ContentOrientation}from"../../Callout";import{FocusZone}from"../../FocusZone";import{Tooltip}from"../../TooltipEx";import{css}from"../../Util";import*as Resources from"../../Resources.TeachingPanel";var TeachingPanel=function(e){function t(t){var n=e.call(this,t)||this;return n.nextButton=React.createRef(),n._onPanelClose=function(){n.setState({shouldShow:!1}),n.props.onDismiss&&n.props.onDismiss(n.state.slideIndex)},n._onNextPressed=function(){n.state.slideIndex+1===n.props.slides.length?n._onPanelClose():n.setState({slideIndex:n.state.slideIndex+1})},n._onBackPressed=function(){n.state.slideIndex>0&&(1===n.state.slideIndex&&n.nextButton.current&&n.nextButton.current.focus(),n.setState({slideIndex:n.state.slideIndex-1}))},n._renderPanel=function(){var e=n.props.slides[n.state.slideIndex],t=0===n.state.slideIndex,o=n.state.slideIndex+1===n.props.slides.length;return e?React.createElement(Callout,{className:"bolt-teaching-panel-layer",contentClassName:"bolt-teaching-panel depth-16",contentJustification:ContentJustification.Center,contentLocation:ContentLocation.Center,contentOrientation:ContentOrientation.Column,contentShadow:!0,escDismiss:!0,lightDismiss:!0,modal:!0,onDismiss:n._onPanelClose},React.createElement(FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-teaching-panel-next",focusOnMount:!0,handleTabKey:!0},React.createElement("div",{className:"bolt-teaching-panel-container flex-grow flex-column scroll-hidden"},React.createElement("div",{className:"bolt-teaching-panel-visual flex-row flex-noshrink"},React.createElement("img",{className:"bolt-teaching-panel-image flex-row",src:e.slideImage,alt:e.imageAltText}),React.createElement(Button,{subtle:!0,className:"bolt-teaching-pane-close-button",ariaLabel:Resources.Close,iconProps:{iconName:"Cancel"},onClick:n._onPanelClose})),React.createElement("div",{className:"bolt-teaching-panel-description flex-column flex-grow padding-16 rhythm-vertical-16 scroll-hidden"},React.createElement(Tooltip,{overflowOnly:!0},React.createElement("span",{className:"bolt-teaching-panel-header title-m text-ellipsis flex-noshrink"},e.title)),React.createElement("span",{className:"bolt-teaching-panel-text flex-grow body-l v-scroll-auto custom-scrollbar",dangerouslySetInnerHTML:{__html:e.description}}),React.createElement("div",{className:"bolt-teaching-panel-buttons flex-row relative"},React.createElement(Button,{text:Resources.Back,onClick:n._onBackPressed,className:css("bolt-teaching-panel-back",t&&"first-slide"),disabled:n.state.slideIndex<=0}),React.createElement(Button,{ref:n.nextButton,primary:!0,text:o?Resources.Done:Resources.Next,onClick:n._onNextPressed,className:"bolt-teaching-panel-next"}),React.createElement("div",{className:"bolt-teaching-panel-progress flex-row flex-grow flex-center justify-center rhythm-horizontal-8 absolute-fill"},n.props.slides.map(function(e,t){return React.createElement("div",{key:"progress-"+t,className:css("bolt-teaching-panel-progress-circle",n.state.slideIndex===t&&"current")})}))))))):null},n.state={slideIndex:0,shouldShow:!0},n}return __extends(t,e),t.prototype.render=function(){return this.state.shouldShow?this._renderPanel():null},t}(React.Component);export{TeachingPanel};